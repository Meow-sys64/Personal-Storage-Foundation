<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
</head>

<body>
  <header>
    <%- include("partials/navbar.ejs") %>
  </header>
  <% if (username){ %>

    <form action="/upload" method="post" enctype="multipart/form-data">
      <label for="file_name">File Name:</label>
      <input type="text" placeholder="Optional" name="file_name" id="file_name">

      <label for="folder_name">Folder Name:</label>
      <select name="folder_name" id="folder_name">
        <option value="newFolder" id="newFolderOption">Create New Folder</option>
        <%if(userFolders && userFolders.length> 0){ %>
          <% userFolders.forEach((item)=>{ %>
            <option>
              <%= item.name %>
            </option>
            <%})%>
              <%} %>
      </select>
      <div id="new-folder-container" >
        <label for="newFolder" style="display: none;">New Folder Name:</label>
        <input type="text" name="newFolder" id="newFolder">
      </div>

      <label for="uploaded_file">Upload File: </label>
      <input type="file" name="uploaded_file" id="uploaded_file" required />

      <button type="submit">Submit</button>
    </form>
    <div class="gallery-container">
    </div>
    <% } %>
</body>
<script>
  // Get the select element and the div container for the input text field
  const dropdown = document.getElementById('folder_name');
  const newFolderContainer = document.getElementById('new-folder-container');
  const newFolder = document.getElementById('newFolder')
  const newFolderOption = document.getElementById('newFolderOption')

  // Add an event listener for the 'change' event on the dropdown
  dropdown.addEventListener('change', function () {
    // Check if the 'Create New' option is selected
    if  ( dropdown.selectedIndex === 0 ){
      // Show the input field
      newFolderContainer.style.display = 'block';
    } else {
      // Hide the input field
      newFolderContainer.style.display = 'none';
    }
  });

  newFolder.addEventListener('input', function () {
    newFolderOption.setAttribute("value", newFolder.value)
  })

</script>

</html>
